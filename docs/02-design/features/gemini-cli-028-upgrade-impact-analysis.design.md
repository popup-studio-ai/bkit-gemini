# Gemini CLI v0.28.2 Upgrade Impact Analysis Design

> **Feature**: gemini-cli-028-upgrade-impact-analysis
> **Date**: 2026-02-12
> **Status**: Design Phase
> **Reference Plan**: [gemini-cli-028-upgrade-impact-analysis.plan.md](../../01-plan/features/gemini-cli-028-upgrade-impact-analysis.plan.md)

---

## 1. Analysis Matrix

We will analyze the codebase against the following v0.28.2 changes:

| ID | Gemini v0.28.2 Feature | bkit Component | Analysis Method | Expected Outcome |
|----|-------------------------|----------------|-----------------|------------------|
| A-01 | Strict Hook Permissions | `hooks/hooks.json` | Review events used vs. new restrictions | No blocking errors; warnings documented |
| A-02 | Hook Script Execution | `hooks/scripts/*.js` | Check for interactive prompts or blocked ops | Scripts run silently or handle UI correctly |
| A-03 | Skill Activation Logic | `lib/skill-orchestrator.js` | Compare custom logic vs. native `activate_skill` | Determine if `lib` needs simplification |
| A-04 | Tool Sandbox/Isolation | `gemini-extension.json` | Check `excludeTools` and file access paths | Confirmation that `bkit` uses allowed paths |
| A-05 | `/agents refresh` | `README.md` (Update Guide) | Verify if docs mention this new command | Update docs if missing |

## 2. Detailed Verification Points

### 2.1 Hook System (A-01, A-02)
*   **Context**: v0.28.2 warns users about hooks.
*   **Check**: Does `bkit` use any "dangerous" hooks (e.g., interfering with core tool execution without fallback)?
*   **File**: `hooks/hooks.json`
*   **Criteria**: Ensure all hooks have clear, non-intrusive purposes.

### 2.2 Skill Orchestration (A-03)
*   **Context**: v0.28.2 optimized `activate_skill`.
*   **Check**: Does `lib/skill-orchestrator.js` manually do things that `activate_skill` now does natively (e.g., excessive context loading)?
*   **Criteria**: Identify redundant code in `skill-orchestrator.js`.

### 2.3 Tool Configuration (A-04)
*   **Context**: Enhanced sandboxing.
*   **Check**: `gemini-extension.json` settings.
*   **Criteria**: Verify `excludeTools` is correctly configured to not break `run_shell_command` usage for PDCA tasks.

## 3. Report Structure

The final report should follow the standard `bkit` report template but focus on "Impact" and "Action Items".

*   **Impact Summary**: High/Medium/Low
*   **Required Changes**: Code changes list
*   **Documentation Updates**: specific lines to change

---

*Generated by bkit CTO Team*
